{"version":3,"sources":["../src/stepper/stepper.ts"],"names":[],"mappings":"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","file":"stepper.js","sourcesContent":["import { SuperComponent, wxComponent } from '../common/src/index';\nimport config from '../common/config';\nimport props from './props';\n\nconst { prefix } = config;\n\n@wxComponent()\nexport default class Stepper extends SuperComponent {\n  externalClasses = [\n    `${{ prefix }}-class`,\n    `${{ prefix }}-class-input`,\n    `${{ prefix }}-class-minus`,\n    `${{ prefix }}-class-plus`,\n  ];\n\n  options = {\n    addGlobalClass: true,\n  };\n\n  properties = props;\n\n  observers = {\n    value(v) {\n      this.setData({\n        currentValue: Number(v),\n      });\n    },\n  };\n\n  data: {\n    currentValue: Number;\n    classPrefix: String;\n    prefix: String;\n  } = {\n    currentValue: 0,\n    classPrefix: `${prefix}-stepper`,\n    prefix,\n  };\n\n  attached() {\n    const { value, min } = this.properties;\n    this.setData({\n      currentValue: value ? Number(value) : min,\n    });\n  }\n\n  isDisabled(type) {\n    const { min, max, disabled } = this.properties;\n    const { currentValue } = this.data as any;\n    if (disabled) {\n      return true;\n    }\n    if (type === 'minus' && currentValue <= min) {\n      return true;\n    }\n    if (type === 'plus' && currentValue >= max) {\n      return true;\n    }\n    return false;\n  }\n\n  format(value) {\n    const { min, max } = this.properties as any;\n    // 超过边界取边界值\n    return Math.max(Math.min(max, value, Number.MAX_SAFE_INTEGER), min, Number.MIN_SAFE_INTEGER);\n  }\n\n  setValue(value) {\n    this.setData({\n      currentValue: value,\n    });\n    this.triggerEvent('change', { value });\n  }\n\n  minusValue() {\n    if (this.isDisabled('minus')) {\n      this.triggerEvent('overlimit', { type: 'minus' });\n      return false;\n    }\n    const { currentValue, step } = this.data as any;\n    this.setValue(this.format(currentValue - step));\n  }\n\n  plusValue() {\n    if (this.isDisabled('plus')) {\n      this.triggerEvent('overlimit', { type: 'plus' });\n      return false;\n    }\n    const { currentValue, step } = this.data as any;\n    this.setValue(this.format(currentValue + step));\n  }\n\n  changeValue(e) {\n    const value =\n      String(e.detail.value)\n        .split('.')[0]\n        .replace(/[^-0-9]/g, '') || 0;\n    this.setValue(this.format(Number(value)));\n    this.triggerEvent('blur', { value });\n  }\n\n  blurHandler(e) {\n    this.changeValue(e);\n  }\n}\n"]}