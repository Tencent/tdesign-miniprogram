{"version":3,"sources":["../src/rate/rate.ts"],"names":[],"mappings":"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","file":"rate.js","sourcesContent":["/*\n * @Author: rileycai\n * @Date: 2021-09-21 19:01:54\n * @LastEditTime: 2021-11-10 14:30:02\n * @LastEditors: rileycai\n * @Description: Rate组件\n * @FilePath: /tdesign-miniprogram/src/rate/rate.ts\n */\nimport { SuperComponent, wxComponent } from '../common/src/index';\nimport config from '../common/config';\nimport props from './props';\n\nconst { prefix } = config;\nconst name = `${prefix}-rate`;\n\nconst rpx2px = (() => {\n  let systemInfo: any = null;\n  return (rpx: number): number => {\n    if (!systemInfo) {\n      systemInfo = wx.getSystemInfoSync();\n    }\n    return (rpx * (systemInfo ? systemInfo.screenWidth : 750)) / 750;\n  };\n})();\n\n@wxComponent()\nexport default class Rate extends SuperComponent {\n  externalClasses = ['t-class', 't-class-icon', 't-class-desc'];\n\n  properties = props;\n\n  controlledProps = [\n    {\n      key: 'value',\n      event: 'change',\n    },\n  ];\n\n  data = {\n    classPrefix: name,\n    icon: 'star-filled',\n    halfIcon: 'star-filled',\n    defaultTexts: ['极差', '失望', '一般', '满意', '惊喜'],\n    disabledColor: '#999999',\n  };\n\n  onTouch(e: any) {\n    const { count, allowHalf, gap, value: currentValue } = this.properties as any;\n    const [touch] = e.touches;\n    const margin = rpx2px(gap);\n    const selQuery = this.createSelectorQuery();\n    selQuery\n      .select(`.${name}__wrapper`)\n      .boundingClientRect((rect: any) => {\n        const { width, left } = rect;\n        const starWidth = (width - (count - 1) * margin) / count;\n        const offsetX = touch.pageX - left;\n        const num = (offsetX + margin) / (starWidth + margin);\n        const remainder = num % 1;\n        const integral = num - remainder;\n        let value = remainder <= 0.5 && allowHalf ? integral + 0.5 : integral + 1;\n        if (value > count) {\n          value = count;\n        } else if (value < 0) {\n          value = 0;\n        }\n        if (value !== currentValue) {\n          this._trigger('change', { value });\n        }\n      })\n      .exec();\n  }\n}\n"]}