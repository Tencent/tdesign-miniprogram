{"version":3,"sources":["../src/transition/transition.ts"],"names":[],"mappings":"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","file":"transition.js","sourcesContent":["import { TdTransitionProps } from './type';\nimport TComponent from '../common/component';\nimport config from '../common/config';\nimport { classNames } from '../common/utils';\n\nconst { prefix } = config;\nconst name = `${prefix}-transition`;\n\nexport type TransitionProps = TdTransitionProps;\n\nTComponent({\n  options: {\n    styleIsolation: 'shared',\n  },\n  properties: {\n    visible: {\n      type: Boolean,\n      observer(current, prev) {\n        if (this.inited && current !== prev) {\n          if (current) {\n            this.enter();\n          } else {\n            this.leave();\n          }\n        }\n      },\n    },\n    destroyOnHide: Boolean,\n    appear: Boolean,\n    customClass: String,\n    name: {\n      type: String,\n      value: name,\n    },\n    durations: {\n      type: Number,\n      optionalTypes: [Array],\n    },\n  },\n  data: {\n    dataVisible: false,\n    transitionClass: '',\n    transitionDurations: 300,\n    className: '',\n  },\n  lifetimes: {\n    created() {\n      this.status = '';\n      this.transitionT = 0;\n    },\n    attached() {\n      this.setClass();\n      this.durations = this.getDurations();\n      if (this.data.appear && this.data.visible) {\n        this.enter();\n      } else if (this.data.visible) {\n        this.setData({\n          dataVisible: true,\n        });\n      }\n      this.inited = true;\n    },\n    detached() {\n      clearTimeout(this.transitionT);\n    },\n  },\n  observers: {\n    'customClass, transitionClass'() {\n      this.setClass();\n    },\n  },\n  methods: {\n    setClass() {\n      const { customClass, transitionClass } = this.data;\n      const className = classNames(customClass, transitionClass);\n      this.setData({\n        className,\n      });\n    },\n    getDurations() {\n      const { durations } = this.data;\n      if (Array.isArray(durations)) {\n        return durations.map((item) => Number(item));\n      }\n      return [Number(durations), Number(durations)];\n    },\n    enter() {\n      const { name } = this.data;\n      const [duration] = this.durations;\n      this.status = 'entering';\n      this.setData({\n        transitionClass: `${name}-enter ${name}-enter-active`,\n        dataVisible: true,\n      });\n      setTimeout(() => {\n        this.setData({\n          transitionClass: `${name}-enter  ${name}-enter-active ${name}-enter-to`,\n        });\n      }, 30);\n      if (typeof duration === 'number' && duration > 0) {\n        this.transitionT = setTimeout(this.entered.bind(this), duration + 30);\n      }\n    },\n    entered() {\n      this.customDuration = false;\n      clearTimeout(this.transitionT);\n      this.status = 'entered';\n      this.setData({\n        transitionClass: '',\n      });\n    },\n    leave() {\n      const { name } = this.data;\n      const [, duration] = this.durations;\n      this.status = 'leaving';\n      this.setData({\n        transitionClass: `${name}-leave  ${name}-leave-active`,\n      });\n      setTimeout(() => {\n        this.setData({\n          transitionClass: [`${name}-leave ${name}-leave-active ${name}-leave-to`],\n        });\n      }, 30);\n      if (typeof duration === 'number' && duration > 0) {\n        this.customDuration = true;\n        this.transitionT = setTimeout(this.leaved.bind(this), duration + 30);\n      }\n    },\n    leaved() {\n      this.customDuration = false;\n      clearTimeout(this.transitionT);\n      this.status = 'leaved';\n      this.setData({\n        transitionClass: '',\n        dataVisible: false,\n      });\n    },\n    onTransitionEnd() {\n      if (this.customDuration) {\n        return;\n      }\n      clearTimeout(this.transitionT);\n      if (this.status === 'entering' && this.data.visible) {\n        this.entered();\n      } else if (this.status === 'leaving' && !this.data.visible) {\n        this.leaved();\n      }\n    },\n  },\n});\n"]}