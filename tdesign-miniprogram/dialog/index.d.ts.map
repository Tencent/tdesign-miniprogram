{"version":3,"sources":["../src/dialog/index.ts"],"names":[],"mappings":";AAEA,aAAK,OAAO,GAAG,iBAAiB,CAAC,IAAI,CAAC,eAAe,GAAG,iBAAiB,CAAC,SAAS,CAAC,eAAe,CAAC;AAEpG,UAAU,sBAAsB;IAC9B,OAAO,CAAC,EAAE,OAAO,CAAC;IAClB,QAAQ,CAAC,EAAE,MAAM,CAAC;IAClB,KAAK,CAAC,EAAE,MAAM,CAAC;IACf,OAAO,EAAE,MAAM,CAAC;IAChB,MAAM,CAAC,EAAE,MAAM,CAAC;IAChB,UAAU,CAAC,EAAE,OAAO,CAAC;IACrB,iBAAiB,CAAC,EAAE,MAAM,CAAC;IAC3B,SAAS,CAAC,EAAE,MAAM,CAAC;IACnB,SAAS,CAAC,EAAE,MAAM,GAAG,MAAM,CAAC;IAC5B,UAAU,CAAC,EAAE,MAAM,GAAG,MAAM,CAAC;CAC9B;AAED,UAAU,wBAAyB,SAAQ,sBAAsB;IAC/D,gBAAgB,CAAC,EAAE,MAAM,CAAC;CAC3B;AAED,UAAU,MAAM;IACd,IAAI,EAAE,MAAM,CAAC;IACb,OAAO,CAAC,EAAE,OAAO,CAAC;IAClB,KAAK,CAAC,EAAE,MAAM,CAAC;CAChB;AAED,UAAU,uBAAuB;IAC/B,OAAO,CAAC,EAAE,OAAO,CAAC;IAClB,QAAQ,CAAC,EAAE,MAAM,CAAC;IAClB,KAAK,CAAC,EAAE,MAAM,CAAC;IACf,OAAO,EAAE,MAAM,CAAC;IAChB,MAAM,CAAC,EAAE,MAAM,CAAC;IAChB,UAAU,CAAC,EAAE,OAAO,CAAC;IACrB,OAAO,CAAC,EAAE,MAAM,EAAE,CAAC;IACnB,YAAY,CAAC,EAAE,UAAU,GAAG,YAAY,CAAC;CAC1C;;mBA8BgB,sBAAsB;qBAcpB,wBAAwB;;oBAsBzB,uBAAuB,GAAG,QAAQ;QAAE,KAAK,EAAE,MAAM,CAAA;KAAE,CAAC;;AArCtE,wBAuDE","file":"index.d.ts","sourcesContent":["import props from './props';\n\ntype Context = WechatMiniprogram.Page.TrivialInstance | WechatMiniprogram.Component.TrivialInstance;\n\ninterface DialogAlertOptionsType {\n  context?: Context;\n  selector?: string;\n  title?: string;\n  content: string;\n  zIndex?: number;\n  asyncClose?: boolean;\n  confirmButtonText?: string;\n  textAlign?: string;\n  cancelBtn?: string | object;\n  confirmBtn?: string | object;\n}\n\ninterface DialogComfirmOptionsType extends DialogAlertOptionsType {\n  cancelButtonText?: string;\n}\n\ninterface Action {\n  name: string;\n  primary?: boolean;\n  style?: string;\n}\n\ninterface DialogActionOptionsType {\n  context?: Context;\n  selector?: string;\n  title?: string;\n  content: string;\n  zIndex?: number;\n  asyncClose?: boolean;\n  actions?: Action[]; // 自定义多选项，优先级高于默认的确定、取消按钮，触发后返回按钮的index\n  buttonLayout?: 'vertical' | 'horizontal'; // 多按钮排列方式，可选值：horizontal/vertical。\n}\n\nconst defaultOptions = {\n  actions: false,\n  buttonLayout: props.buttonLayout.value,\n  cancelBtn: props.cancelBtn.value,\n  closeOnOverlayClick: props.closeOnOverlayClick.value,\n  confirmBtn: props.confirmBtn.value,\n  content: '',\n  preventScrollThrough: props.preventScrollThrough.value,\n  showOverlay: props.showOverlay.value,\n  title: '',\n  visible: props.visible.value,\n};\n\nconst getDialogInstance = function (context?: Context, selector = '#t-dialog') {\n  if (!context) {\n    const pages = getCurrentPages();\n    const page = pages[pages.length - 1];\n    context = page.$$basePage || page;\n  }\n  const instance = context ? context.selectComponent(selector) : null;\n  if (!instance) {\n    console.warn('未找到dialog组件,请检查selector是否正确');\n    return null;\n  }\n  return instance;\n};\n\nexport default {\n  alert(options: DialogAlertOptionsType) {\n    const { context, selector, ...otherOptions } = { ...defaultOptions, ...options };\n    const instance = getDialogInstance(context, selector);\n    if (!instance) return Promise.reject();\n\n    return new Promise((resolve) => {\n      instance.setData({\n        cancelBtn: '',\n        ...otherOptions,\n        visible: true,\n      });\n      instance._onComfirm = resolve;\n    });\n  },\n  confirm(options: DialogComfirmOptionsType) {\n    const { context, selector, ...otherOptions } = { ...defaultOptions, ...options };\n    const instance = getDialogInstance(context, selector);\n    if (!instance) return Promise.reject();\n\n    return new Promise((resolve, reject) => {\n      instance.setData({\n        ...otherOptions,\n        visible: true,\n      });\n      instance._onComfirm = resolve;\n      instance._onCancel = reject;\n    });\n  },\n  close() {\n    const instance = getDialogInstance();\n    if (instance) {\n      instance.close();\n      return Promise.resolve();\n    }\n    return Promise.reject();\n  },\n  action(options: DialogActionOptionsType): Promise<{ index: number }> {\n    const { context, selector, actions, ...otherOptions } = { ...defaultOptions, ...options };\n    const instance = getDialogInstance(context, selector);\n    if (!instance) return Promise.reject();\n    if (!actions || (typeof actions === 'object' && (actions.length === 0 || actions.length > 7))) {\n      console.warn('action 数量建议控制在1至7个');\n    }\n\n    return new Promise((resolve) => {\n      instance.setData({\n        actions,\n        buttonLayout: 'vertical',\n        ...otherOptions,\n        visible: true,\n      });\n      instance._onAction = resolve;\n    });\n  },\n};\n"]}