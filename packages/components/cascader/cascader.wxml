<wxs src="../common/utils.wxs" module="_" />

<t-popup class="class" visible="{{visible}}" placement="bottom" bind:visible-change="onVisibleChange">
  <view style="{{_._style([style, customStyle])}}" class="{{classPrefix}}">
    <view class="{{classPrefix}}__title">
      <slot name="title" />
      {{title || globalConfig.title}}
    </view>
    <view class="{{classPrefix}}__close-btn" bind:tap="onClose">
      <slot name="close-btn" />
      <t-icon wx:if="{{closeBtn}}" size="48rpx" name="close" />
    </view>

    <slot name="header" />

    <view class="{{classPrefix}}__content">
      <block wx:if="{{steps && steps.length}}">
        <view wx:if="{{theme == 'step'}}" class="{{classPrefix}}__steps">
          <view
            wx:for="{{steps}}"
            wx:key="index"
            class="{{classPrefix}}__step"
            bind:tap="onStepClick"
            data-index="{{index}}"
          >
            <view
              class="{{classPrefix}}__step-dot {{classPrefix}}__step-dot--{{item !== placeholder ? 'active' : ''}} {{classPrefix}}__step-dot--{{index === steps.length - 1 ? 'last' : ''}}"
            ></view>
            <view
              class="{{classPrefix}}__step-label {{classPrefix}}__step-label--{{index === stepIndex ? 'active' : ''}}"
            >
              {{ item }}
            </view>
            <t-icon name="chevron-right" size="44rpx" t-class="{{classPrefix}}__step-arrow" />
          </view>
        </view>
        <block wx:if="{{theme == 'tab'}}">
          <t-tabs id="tabs" value="{{stepIndex}}" bind:change="onTabChange" space-evenly="{{false}}">
            <t-tab-panel wx:for="{{steps}}" wx:key="index" value="{{index}}" label="{{item}}" />
          </t-tabs>
        </block>
      </block>
      <slot name="middle-content" />
      <view wx:if="{{ subTitles && subTitles[stepIndex] }}" class="{{classPrefix}}__options-title"
        >{{subTitles[stepIndex]}}</view
      >
      <view
        class="{{classPrefix}}__options-container"
        style="width: {{items.length + 1}}00vw; transform: translateX(-{{stepIndex}}00vw)"
      >
        <scroll-view
          wx:for="{{items}}"
          wx:for-item="options"
          wx:key="index"
          class="{{classPrefix}}__options"
          scroll-y
          scroll-top="{{scrollTopList[index]}}"
          type="list"
          style="height: {{_optionsHeight}}px"
        >
          <view class="cascader-radio-group-{{index}}">
            <t-radio-group
              value="{{selectedValue[index]}}"
              keys="{{keys}}"
              options="{{options}}"
              bind:change="handleSelect"
              data-level="{{index}}"
              placement="right"
              icon="line"
              borderless
            >
            </t-radio-group>
          </view>
        </scroll-view>
      </view>
    </view>
  </view>
</t-popup>
