@import '../../../components/common/style/base.less';

@chat-content: ~'@{prefix}-chat-content';

// TODO: 建议用组件名作类名前缀
@chat-message: ~'@{prefix}-chat';

@chat-message-content-padding: 24rpx 32rpx;
@chat-message-height: 44rpx;

.@{chat-message} {
  // 反向列表样式
  &__list--reverse {
    .@{chat-message}__inner {
      -webkit-transform: scaleY(-1);
      transform: scaleY(-1);
    }
  }
  // 内部容器样式
  &__inner {
    display: flex;
    margin-bottom: @spacer-2;

    // 头像样式
    .@{chat-message}__avatar {
      flex: 0 0 auto;
      padding-top: 0rpx;
    }

    // 内容容器样式
    .@{chat-message}__content {
      flex: 1 1 auto;
      width: 1%;
    }

    // 基础内容样式
    .@{chat-message}__content--base {
      padding-top: @spacer-3;
    }

    // 详情容器样式
    .@{chat-message}__detail {
      max-width: 100%;
      box-sizing: border-box;
      display: contents;
    }

    // 有头部时的样式
    &--hasheader {
      .@{chat-message}__avatar {
        padding-top: calc(@chat-message-height + @spacer);
      }
    }

    // 用户消息样式
    &.user {
      .@{chat-message}__skeleton {
        align-items: flex-end;
      }
      .@{chat-message}__base {
        padding-right: @spacer-2;
      }
    }

    // 助手消息样式
    &.assistant {
      .@{chat-message}__skeleton {
        align-items: flex-start;
      }
      .@{chat-message}__base {
        padding-left: @spacer-2;
      }
    }

    // 错误消息样式
    &.error {
      .@{chat-message}__skeleton {
        align-items: flex-start;
      }
      .@{chat-message}__base {
        padding-left: @spacer-2;
      }
      .@{chat-message}__text--error {
        color: @error-color-6;
      }
    }

    // 左侧布局样式
    &.left {
      display: flex;
      flex-direction: row;
      .@{chat-message}__content {
        align-items: flex-start;
      }
      .@{chat-message}__skeleton {
        align-items: flex-start;
      }
      .@{chat-message}__base {
        padding-left: @spacer-2;
      }
    }

    // 右侧布局样式
    &.right {
      display: flex;
      flex-direction: row-reverse;
      .@{chat-message}__content {
        align-items: flex-end;
      }
      .@{chat-message}__skeleton {
        align-items: flex-end;
      }
      .@{chat-message}__base {
        padding-right: @spacer-2;
      }
      .@{chat-message}__avatar {
        margin-left: @spacer-1;
      }
    }
  }

  // 头像样式
  &__avatar {
    flex-shrink: 0;
    cursor: pointer;
    display: flex;
    margin-right: @spacer-1;
    padding-top: calc(@chat-message-height + @spacer);

    &__box {

    }

    &-image {
      width: @spacer-4;
      height: @spacer-4;
      border-radius: @radius-circle;
    }
  }

  // 内容容器样式
  &__content {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: center;
    font-size: @font-size-m;
    line-height: 48rpx;
    font-family: @font-family;
    .t-skeleton {
      width: 100%;
      // padding: @spacer-2;
    }
  }

  // 基础信息样式
  &__base {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    height: @chat-message-height;
    font-size: @font-size-base;
    line-height: @chat-message-height;
    font-family: @font-family;
    color: @text-color-placeholder;
    // padding-left: @spacer-2;
    margin-bottom: @spacer;
  }

  // 名称样式
  &__name {
    padding-right: @spacer;
    cursor: pointer;
  }

  // 文本变体样式
  &__text--variant--text {
    .@{chat-content} {
      &__user,
      &__assistant {
        color: @text-color-secondary;
      }
    }
  }

  &__text--variant--base {
    .@{chat-content} {
      padding: @chat-message-content-padding;
      background-color: @bg-color-secondarycontainer;
      border-radius: 0 @radius-extraLarge @radius-extraLarge
        @radius-extraLarge;
    }

    &.assistant .@{chat-content} {
      border-radius: 0 @radius-extraLarge @radius-extraLarge
        @radius-extraLarge;
      background-color: transparent;
      padding: 0;
    }

    &.user .@{chat-content} {
      border-radius: 0 @radius-extraLarge @radius-extraLarge
        @radius-extraLarge;
    }

    &.left .@{chat-content} {
      border-radius: 0 @radius-extraLarge @radius-extraLarge
        @radius-extraLarge;
    }

    &.right .@{chat-content} {
      border-radius: @radius-extraLarge 0 @radius-extraLarge
        @radius-extraLarge;
    }
  }

  &__text--variant--outline {
    .@{chat-content}  {
      padding: @chat-message-content-padding;
      border: 1rpx solid @component-border;
      border-radius: 0 @radius-extraLarge @radius-extraLarge
        @radius-extraLarge;
    }

    &.assistant .@{chat-content} {
      border-radius: 0 @radius-extraLarge @radius-extraLarge
        @radius-extraLarge;
    }

    &.user .@{chat-content} {
      border-radius: 0 @radius-extraLarge @radius-extraLarge
        @radius-extraLarge;
    }

    &.left .@{chat-content} {
      border-radius: 0 @radius-extraLarge @radius-extraLarge
        @radius-extraLarge;
    }

    &.right .@{chat-content} {
      border-radius: @radius-extraLarge 0 @radius-extraLarge
        @radius-extraLarge;
    }
  }

  // Actionbar 插槽样式
  &__actionbar-slot {
    // margin-top: @spacer-1;
    --chat-actionbar-padding: @spacer-1 0 0 0;

    &:empty {
      display: none;
    }
  }
}

// 正常模式下的特殊样式
.@{chat-message}-is-normal {
  .@{chat-message}__inner {
    &.user {
      flex-direction: row-reverse;

      .@{chat-message}__avatar {
        margin-right: 0;
        margin-left: 24rpx;
      }

      .@{chat-message}__content {
        align-items: flex-end;
      }

      .@{chat-message}__content .@{chat-message}__base {
        justify-content: flex-end;
      }
    }
  }

  .@{chat-message}__detail {
    max-width: 100%;
  }

  .@{chat-message}__text--variant--base {
    &.user .@{chat-content} {
      border-radius: @radius-extraLarge 0 @radius-extraLarge
        @radius-extraLarge;
    }

    &.assistant .@{chat-content} {
      border-radius: 0 @radius-extraLarge @radius-extraLarge
        @radius-extraLarge;
    }
  }

  .@{chat-message}__text--variant--outline {
    &.user .@{chat-content} {
      border-radius: @radius-extraLarge 0 @radius-extraLarge
        @radius-extraLarge;
    }

    &.assistant .@{chat-content} {
      border-radius: 0 @radius-extraLarge @radius-extraLarge
        @radius-extraLarge;
    }
  }
}
