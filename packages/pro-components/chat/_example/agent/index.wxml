<view>
  <t-chat class="chat-box">
    <block wx:for="{{chatList}}" wx:key="index" wx:for-index="chatIndex">
      <t-chat-message avatar="{{item.avatar}}" name="{{item.name}}" datetime="{{item.datetime}}"
        role="{{item.message.role}}">
        <view slot="content">
          <block wx:for="{{item.message.content}}" wx:for-item="contentItem" wx:for-index="contentIndex"
            wx:key="contentIndex">
            <t-chat-content content="{{contentItem}}"
              wx:if="{{contentItem.type === 'text' || contentItem.type === 'markdown'}}" />
            <view class="step" wx:if="{{contentItem.type === 'agent'}}">
              <view>{{contentItem.content.text}}</view>
              <t-steps layout="vertical" current="{{contentItem.content.steps.length}}">
                <t-step-item wx:for="{{contentItem.content.steps}}" wx:key="index" title="{{item.step}}">
                  <view slot="content" class="step-text-list">
                    <view wx:for="{{item.tasks}}" wx:key="index" wx:for-item="taskItem"
                      class="{{['step-text', taskItem.type]}}">
                      {{taskItem.text}}
                    </view>
                  </view>
                </t-step-item>
              </t-steps>
            </view>
          </block>
        </view>
      </t-chat-message>
    </block>
    <view slot="footer">
      <t-chat-sender value="{{value}}" loading="{{loading}}" disabled="{{disabled}}" bind:send="onSend"
        bind:stop="onStop" bind:focus="onFocus" />
    </view>
  </t-chat>
</view>